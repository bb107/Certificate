#pragma once
#include <Windows.h>

//Common Enhanced Key Usage
#define ENHKEYUSAGE_SERVER_AUTH								0x00000001
#define ENHKEYUSAGE_CLIENT_AUTH								0x00000002
#define ENHKEYUSAGE_CODE_SIGNING							0x00000004
#define ENHKEYUSAGE_EMAIL_PROTECTION						0x00000008
#define ENHKEYUSAGE_TIMESTAMP_SIGNING						0x00000010
#define ENHKEYUSAGE_OCSP_SIGNING							0x00000020
//Windows Only
#define ENHKEYUSAGE_CTL_USAGE_SIGNING						0x00000040
#define ENHKEYUSAGE_TIME_STAMP_SIGNING						0x00000080
#define ENHKEYUSAGE_EFS_RECOVERY							0x00000100
#define ENHKEYUSAGE_NT5_CRYPTO								0x00000200
#define ENHKEYUSAGE_ROOT_LIST_SIGNER						0x00000400
#define ENHKEYUSAGE_KEY_RECOVERY							0x00000800
#define ENHKEYUSAGE_DOCUMENT_SIGNING						0x00001000
#define ENHKEYUSAGE_LIFETIME_SIGNING						0x00002000
#define ENHKEYUSAGE_MOBILE_DEVICE_SOFTWARE					0x00004000
#define ENHKEYUSAGE_CSP_SIGNATURE							0x00008000
#define ENHKEYUSAGE_FLIGHT_SIGNING							0x00010000
#define ENHKEYUSAGE_DRM_INDIVIDUALIZATION					0x00020000
#define ENHKEYUSAGE_LICENSE_SERVER							0x00040000
#define ENHKEYUSAGE_SMARTCARD_LOGON							0x00080000
#define ENHKEYUSAGE_KERNEL_MODE_CODE_SIGNING				0x00100000
#define ENHKEYUSAGE_KERNEL_MODE_TRUSTED_BOOT_SIGNING		0x00200000
#define ENHKEYUSAGE_REVOKED_LIST_SIGNER						0x00400000
#define ENHKEYUSAGE_WINDOWS_KITS_SIGNER						0x00800000
#define ENHKEYUSAGE_WINDOWS_RT_SIGNER						0x01000000
#define ENHKEYUSAGE_PROTECTED_PROCESS_LIGHT_SIGNER			0x02000000
#define ENHKEYUSAGE_WINDOWS_TCB_SIGNER						0x04000000
#define ENHKEYUSAGE_PROTECTED_PROCESS_SIGNER				0x08000000
#define ENHKEYUSAGE_WINDOWS_THIRD_PARTY_COMPONENT_SIGNER	0x10000000
#define ENHKEYUSAGE_WINDOWS_SOFTWARE_EXTENSION_SIGNER		0x20000000
#define ENHKEYUSAGE_WHQL_CRYPTO								0x40000000
#define ENHKEYUSAGE_OEM_WHQL_CRYPTO							0x80000000

extern LPSTR* EnhancedKeyUsageList;

typedef struct _ADD_ENHKEY_SET {
	DWORD dwUsage;
	LPSTR UsageIdentifiers[ANYSIZE_ARRAY];
}ADD_ENHKEY_SET, * PADD_ENHKEY_SET;
